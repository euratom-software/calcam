

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Calibration Results &mdash; Calcam  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CAD Models" href="api_cadmodel.html" />
    <link rel="prev" title="Camera Movement Determination" href="gui_movement.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                Version 2.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro_general.html">General Introduction to Calcam</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_install_setup.html">Getting Up &amp; Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_theory.html">Camera Calibration Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_conventions.html">Concepts &amp; Conventions</a></li>
</ul>
<p class="caption"><span class="caption-text">GUI App User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gui_intro.html">Introduction &amp; Launcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_settings.html">Calcam Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_calib.html">Calibration by point fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_alignment_calib.html">Calibration by manual alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_virtual_calib.html">“Virtual” Calibrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_image_analyser.html">Image Analyser</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_viewer.html">3D Viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_movement.html">Camera Movement Determination</a></li>
</ul>
<p class="caption"><span class="caption-text">API User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using Calibration Results</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-calibration-class">The Calibration Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ray-casting">Ray casting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_cadmodel.html">CAD Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_rendering.html">Rendering Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_geom_matrix.html">Tomography Geometry Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_movement.html">Camera Movement Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dev_imsources.html">Image Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_coord_formatter.html">3D Coordinate Formatters</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Calcam</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Using Calibration Results</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-calibration-results">
<h1>Using Calibration Results<a class="headerlink" href="#using-calibration-results" title="Permalink to this headline">¶</a></h1>
<p>Once you have created calibrations using the Calcam GUI tools, you can import calcam as a Python package and use it to extract information from the calibrations and/or integrate use of the results in to your workflow in Python. This page documents the features of the Calcam API for working with calibration results.</p>
<p>For examples of using these features, see the <a class="reference internal" href="api_examples.html"><span class="doc">Examples</span></a> page.</p>
<div class="section" id="the-calibration-class">
<h2>The Calibration Class<a class="headerlink" href="#the-calibration-class" title="Permalink to this headline">¶</a></h2>
<p>The calibration class is used to represent Calcam calibrations and provides various methods for getting information about the camera viewing geometry.</p>
<dl class="py class">
<dt id="calcam.Calibration">
<em class="property">class </em><code class="sig-prename descclassname">calcam.</code><code class="sig-name descname">Calibration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cal_type</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing a camera view calibration.</p>
<p>A complete Calibration object contains the camera
image which was calibrated (if any), the point
pairs used for fitting (if applicable), the camera
model parameters, and metadata about each of these.</p>
<p>If instantiated with the name of a .ccc file to load,
the resulting  object represents the calibration
contained in that file. If no file name is given, an
empty calibration object of a specified type is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_filename</strong> (<em>str</em>) – File name of the calibration to load. If not given, an “empty”                              calibration object is created.</p></li>
<li><p><strong>cal_type</strong> (<em>str</em>) – Required only if load_file is not specified i.e. creating an empty                              calibration object. Must be one of “fit”, “alignment” or “virtual”.                             If load_file is provided, this is ignored.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="calcam.Calibration.get_cam_matrix">
<code class="sig-name descname">get_cam_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subview</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_cam_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the camera matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subview</strong> (<em>int</em>) – For calibrations with multiple sub-views,                             which sub-view index to return the camera                             matrix for.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>3x3 camera matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.get_cam_roll">
<code class="sig-name descname">get_cam_roll</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subview</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">centre</span><span class="o">=</span><span class="default_value">'optical'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_cam_roll" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the camera roll. This is the angle between the projection of the lab +Z axis in the image
and the vertical “up” direction on the detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subview</strong> (<em>int</em>) – For calibrations with multiple sub-views,                             which sub-view index to return the camera                             roll for.</p></li>
<li><p><strong>centre</strong> (<em>str</em>) – At what image position to measure the “camera roll”.                             ‘optical’ - at the optical axis (default);                             ‘detector’ - at the detector centre; or                             ‘subview’ - at the centre of the relevant sub-view.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Camera roll in degrees. Positive angles correspond to a clockwise                             roll of the camera i.e. anti-clockwise roll of the image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.get_cam_to_lab_rotation">
<code class="sig-name descname">get_cam_to_lab_rotation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subview</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_cam_to_lab_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a 3D rotation matrix which will rotate a point in the camera coordinate system
(see Calcam theory documentation) in to the lab coordinate system’s orientation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subview</strong> (<em>int</em>) – For calibrations with multiple sub-views, specifies which sub-view                            to return the rotation matrix for.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>3x3 rotation matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.get_fov">
<code class="sig-name descname">get_fov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subview</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fullchip</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_fov" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the camera field of view.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subview</strong> (<em>int</em>) – For calibrations with multiple sub-views,                               which sub-view index to return the field                               of view for.</p></li>
<li><p><strong>fullchip</strong> (<em>bool</em>) – For calibrations with multiple sub-views,                               setting this to True will return the field of                               view defined by the camaera model of the specified                               sub-view, as if that sub-view covered the whole image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2-element tuple containing the full angles of the horizontal and                               vertical fields of view (h_fov,v_fov) in degrees.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.get_image">
<code class="sig-name descname">get_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the image which was calibrated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Original</span></code>,                                      what orientation to return the image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If the calibration contains an image: returns image data array                                      with shape (h x w x n) where n is the number of colour                                      channels in the image. If the calibration does not contain                                      an image, returns None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray or NoneType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.get_los_direction">
<code class="sig-name descname">get_los_direction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em>, <em class="sig-param"><span class="n">subview</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_los_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Get unit vectors representing the directions of the camera’s sight-lines in 3D space.</p>
<p>Can be used together with <a class="reference internal" href="#calcam.Calibration.get_pupilpos" title="calcam.Calibration.get_pupilpos"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_pupilpos()</span></code></a> to obtain a full description of the camera’s sight-line geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> (<em>sequence of floats</em>) – Image pixel coordinates at which to get the sight-line directions.                                          x and y must be the same shape. If not specified, the line of sight direction                                          at the centre of every detector pixel is returned.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Original</span></code>, specifies which image orientation the provided x and y                                          inputs and/or shape of the returned array correspond to.</p></li>
<li><p><strong>subview</strong> (<em>int</em>) – If specified, forces the use of the camera model from the specified sub-view index.                                          If not given, the correct sub-view(s) will be chosen automatically.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of sight-line vectors. If specifying x_pixels and y_pixels, the output array will be                                          the same shape as the input arrays but with an extra dimension added. The extra dimension contains                                          the [X,Y,Z] components of the sight-line vectors. If not specifying x_pixels and y_pixels, the output                                          array shape will be (h x w x 3) where w and h are the image width and height in pixels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.get_pupilpos">
<code class="sig-name descname">get_pupilpos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'display'</span></em>, <em class="sig-param"><span class="n">subview</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_pupilpos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the camera pupil position in 3D space.</p>
<p>Can be used together with <a class="reference internal" href="#calcam.Calibration.get_los_direction" title="calcam.Calibration.get_los_direction"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_los_direction()</span></code></a> to obtain a full
description of the camera’s sight line geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> (<em>float</em><em> or </em><em>numpy.ndarray</em>) – For calibrations with more than one subview, get the pupil                                            position(s) corresponding to these given image pixel coordinates.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Only used if x and y are also given. Either <code class="docutils literal notranslate"><span class="pre">Display</span></code>                                            or <code class="docutils literal notranslate"><span class="pre">Original</span></code>, specifies whether the provided x and y are in                                            display or original coordinates.</p></li>
<li><p><strong>subview</strong> (<em>int</em>) – Which sub-view to get the pupil position for.                                            Only required for calibrations with more than 1                                            sub-view.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Camera pupil position in 3D space. If not specifying                                           x or y inputs, this will be a 3 element array containing                                           the [X,Y,Z] coordinates of the pupil position in metres.                                           If using x and y inputs, the output array will be the same                                           shape as the x and y input arrays with an additional dimension                                           added; the X, Y and Z components are then given along the new                                           new array dimension.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.get_raysect_camera">
<code class="sig-name descname">get_raysect_camera</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em>, <em class="sig-param"><span class="n">binning</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_raysect_camera" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a RaySect observer corresponding to the calibrated camera.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Original</span></code> specifying                               the orientation of the raysect camera.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RaySect camera object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>raysect.optical.observer.imaging.VectorCamera</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.get_undistort_coeffs">
<code class="sig-name descname">get_undistort_coeffs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">radial_terms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_tangential</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">subview</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.get_undistort_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a set of parameters which can be used to analytically calculate image coordinate un-distortion.
This can be useful if you need to calculate point un-distortion faster than the usual numerical method.
This fits a model of the form of the <a class="reference internal" href="intro_theory.html#distortion-eqn"><span class="std std-ref">perspective distortion model</span></a> but with coordinate vectors
<span class="math notranslate nohighlight">\((x_n, y_n)\)</span> and <span class="math notranslate nohighlight">\((x_d,y_d)\)</span> interchanged. Which coefficients are included can be set by optional input
arguments; by default the same terms which were enabled in the calibration fit are also included in this
fit. Note: this function does not work with fisheye calibrations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radial_terms</strong> (<em>int</em>) – Number of terms to include in the radial distortion model, can be in                                         the range 1 - 3. If &lt; 3, higher order coefficients are set to 0.                                         If not provided, uses the same number of terms as the calibration fit.</p></li>
<li><p><strong>include_tangential</strong> (<em>bool</em>) – Whether to include the tangential distortion coefficients p1 and p2.                                         If not given, uses the same option as was used in the calibration.</p></li>
<li><p><strong>subview</strong> (<em>int</em>) – For calibrations with multiple sub-views, what sub-view to get the parameters for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the fitted coeffcients. Radial distortion coefficients are in keys:                    ‘k1’, ‘k2’ and ‘k3’; tangential coefficients are in keys ‘p1’ and ‘p2’. An additional key ‘rms_error’                    gives the RMS fit error, in pixels, which indicates how well these fitted parameters reproduce                    the full numerical distortion inversion.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.project_points">
<code class="sig-name descname">project_points</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">points_3d</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'display'</span></em>, <em class="sig-param"><span class="n">check_occlusion_with</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">nan</span></em>, <em class="sig-param"><span class="n">occlusion_tol</span><span class="o">=</span><span class="default_value">0.001</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.project_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the image coordinates corresponding to given real-world 3D coordinates.</p>
<p>Optionally can also check whether the 3D points are hidden from the camera’s view by part of the CAD model being in the way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points_3d</strong> – 3D point coordinates, in metres, to project on to the image. Can be EITHER an Nx3 array, where N is the                                                    number of 3D points and each row gives [X,Y,Z] for a 3D point, or a sequence of 3 element sequences,                                                   where each 3 element array specifies a 3D point.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Original</span></code>, specifies which image orientation the returned image coordinates                                                    should correspond to.</p></li>
<li><p><strong>check_occlusion_with</strong> (<a class="reference internal" href="api_cadmodel.html#calcam.CADModel" title="calcam.CADModel"><em>calcam.CADModel</em></a><em> or </em><a class="reference internal" href="#calcam.RayData" title="calcam.RayData"><em>calcam.RayData</em></a>) – If provided and fill_value is not None, for each 3D point the function will check if the point                                                    is hidden from the camera’s view by part of the provided CAD model. If a point is hidden its                                                    returned image coordinates are set to fill_value. Note: if using a RayData onject, always use Raydata resulting                                                    from a raycast of the complete detector, or else project_points will be incredibly slow.</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) – For any 3D points not visible to the camera, the returned image coordinates will be set equal to                                                    this value. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, image coordinates will be returned for every 3D point even if the                                                    point is outside the camera’s field of view or hidden from view.</p></li>
<li><p><strong>occlusion_tol</strong> (<em>float</em>) – Tolerance (in mrtres) to use to check point occlusion. Try increasing this value if having trouble                                                    with points being wrongly detected as occluded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of Nx2 NumPY arrays containing the image coordinates of the given 3D points (N is the number of input 3D points).                                                   Each NumPY array corresponds to a single sub-view, so for images without multuiple sub-views this will return a single element                                                   list containing an Nx2 array. Each row of the NumPY arrays contains the [X,Y] image coordinates of the corresponding input point.                                                   If fill_value is not None, points not visible to the camera have their coordinates set to <code class="docutils literal notranslate"><span class="pre">[fill_value,</span> <span class="pre">fill_value]</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.set_detector_window">
<code class="sig-name descname">set_detector_window</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window</span></em>, <em class="sig-param"><span class="n">bounds_error</span><span class="o">=</span><span class="default_value">'warn'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.set_detector_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust the calibration to apply to a different detector region for than was used
to perform the calibration. Useful for example if a CMOS camera has been calibrated
over the full frame, but you now want to use this calibration for data which
has been cropped.</p>
<p>Calling this function with windiw=`None` sets the calibration
back to its “native” state. Otherwise, call with a 4 element tuple specifying the
left,top,width and height of the detector window.</p>
<p>Detector window coordinates must always be in original coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window</strong> (<em>sequence</em>) – Either <cite>None</cite> or a 4-element sequence of integers defining the                                      detector window coordinates (Left,Top,Width,Height). This MUST                                      be specified in ‘original’ detector coordinates (i.e. before any                                      image rotation, flips etc).</p></li>
<li><p><strong>bounds_error</strong> (<em>str</em>) – How to handle the case for calibrations with multiple                                      sub-views if the requested detector region goes outside                                      the original calibration i.e. the outside the defined sub-view                                      map. ‘except’ will raise an exception, ‘warn’ will raise a warning                                      and ‘silent’ will not alert the user at all. If ‘warn’ or ‘silent’,                                      only pixels within the original calibrated area will be usable. Default is ‘warn’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.set_extrinsics">
<code class="sig-name descname">set_extrinsics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">campos</span></em>, <em class="sig-param"><span class="n">upvec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">camtar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">view_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cam_roll</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">src</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.set_extrinsics" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually set the camera extrinsic parameters.
Only applicable for synthetic or manual alignment type calibrations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>campos</strong> (<em>sequence</em>) – 3-element sequence specifying the camera position (X,Y,Z) in metres.</p></li>
<li><p><strong>view_dir</strong> (<em>sequence</em>) – 3D vector [X,Y,Z] specifying the camera view direction. Either view_dir or camtar must                                   be given; if both are given then view_dir is used.</p></li>
<li><p><strong>camtar</strong> (<em>sequence</em>) – 3-element sequence specifying a point in 3D space where the camera is pointed to.                                   Either camtar or view_dir must be given; if both are given then view_dir is used.</p></li>
<li><p><strong>upvec</strong> (<em>sequence</em>) – 3-element sequence specifying the camera up vector. Either upvec or cam_roll must                                   be given; if both are given then upvec is used. upvec must be orthogonal to the viewing                                   direction.</p></li>
<li><p><strong>cam_roll</strong> (<em>float</em>) – Camera roll in degrees. This is the angle between the lab +Z axis and the camera’s “view up”                                   direction. Either cam_roll or upvec must be given; if both are given the upvec is used.</p></li>
<li><p><strong>src</strong> (<em>str</em>) – Human-readable string describing where these extrinsics come from, for data provenance.                                   If not given, basic information like current username, hostname and time are used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.Calibration.undistort_image">
<code class="sig-name descname">undistort_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'display'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.Calibration.undistort_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct lens distortion a given image from the calibrated camera,
to give an image with a pure perspective projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em>) – (h x w x N) array containing the image to be un-distorted,
where N is the number of colour channels.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Original</span></code>, specifies which orientation                                  the input image is in.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Image data array the same shape as the input array containing the                                  corrected image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="ray-casting">
<h2>Ray casting<a class="headerlink" href="#ray-casting" title="Permalink to this headline">¶</a></h2>
<p>The calibration class can provide line-of-sight directions for given pixel coordinates, however it is often necessary to know where these sight lines terminate at a surface in the CAD model. For example in calculation of geometry matricies for camera data inversion, the length of each camera sight line needs to be known. The function <a class="reference internal" href="#calcam.raycast_sightlines" title="calcam.raycast_sightlines"><code class="xref py py-func docutils literal notranslate"><span class="pre">calcam.raycast_sightlines()</span></code></a> is provided for this purpose; it determines the 3D coordinates where the given pixels’ sight-lines intersect the CAD model.</p>
<dl class="py function">
<dt id="calcam.raycast_sightlines">
<code class="sig-prename descclassname">calcam.</code><code class="sig-name descname">raycast_sightlines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">calibration</span></em>, <em class="sig-param"><span class="n">cadmodel</span></em>, <em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclusion_radius</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">binning</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">intersecting_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">force_subview</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">status_callback</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calc_normals</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.raycast_sightlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Ray cast camera sight-lines to determine where they intersect the given CAD model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calibration</strong> (<a class="reference internal" href="#calcam.Calibration" title="calcam.Calibration"><em>calcam.Calibration</em></a>) – Calibration whose sight-lines to raycast.</p></li>
<li><p><strong>cadmodel</strong> (<a class="reference internal" href="api_cadmodel.html#calcam.CADModel" title="calcam.CADModel"><em>calcam.CADModel</em></a>) – CAD model to check intersection with.</p></li>
<li><p><strong>y</strong> (<em>x</em><em>,</em>) – x and y image pixel coordinates for which to cast sight-lines.                                            If not specified, one ray is cast at the centre of every detector pixel.                                           x and y must be the same shape.</p></li>
<li><p><strong>exclusion_radius</strong> (<em>float</em>) – Distance from camera pupil (in meters) over which to ignore ray                                            intersections with CAD surfaces.                                            This is useful for views involving mirrors and/or prisms where unfolding                                            the optical path results in the virtual pupil location falling behind                                            nearby CAD surfaces. Setting a sufficient exclusion radius will cause the                                            rays to be launched from the other side of these surfaces so they intersect                                            the correct surfaces present in the image.</p></li>
<li><p><strong>binning</strong> (<em>int</em>) – If not explicitly providing x and y image coordinates, pixel binning for ray casting.                                           This specifies NxN binning, i.e. for a value of 2, one ray is cast at the centre of                                            every 2x2 cluster of pixels.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Original</span></code>. If specifying x and y coordinates,                                           specifies whether the input x and y are in original or display coords.                                            Otherwise, specifies the orientation of the returned data.</p></li>
<li><p><strong>intersecting_only</strong> (<em>bool</em>) – If set to True, the ray end coordinates and length for sight-lines which do not intersect                                            with the CAD model (i.e. sight lines which “escape” through holes in the model) are set to NaN.                                            This is useful if you are only interested in sight-lines which intersect with CAD model surfaces.</p></li>
<li><p><strong>force_subview</strong> (<em>int</em>) – If specified, forces use of the camera model from this index of sub-view                                            in the calibration. Otherwise, sub-views are chosen according to the                                            sub-view mask in the calibration.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print status updates during ray casting (depreciated in favour of status_callback)</p></li>
<li><p><strong>status_callback</strong> (<em>callable</em>) – Callable which takes a single argument to be called with status updates. The argument will                                            either be a string for textual status updates or a float from 0 to 1 specifying the progress                                            of the calculation. If set to None, no status updates are issued. For backwards compatibility,                                            if set to None but verbose is set to True, status_callback will be set such that status updates                                            go to stdout.</p></li>
<li><p><strong>calc_normals</strong> (<em>bool</em>) – Whether to calculate the normal vectors of the CAD model where the sight-lines intersect it.                                            Not turned on by default because it seems to add around 80% extra calculation time, so best used                                            only if actyally needed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Object containing the results.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#calcam.RayData" title="calcam.RayData">calcam.RayData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="calcam.RayData">
<em class="property">class </em><code class="sig-prename descclassname">calcam.</code><code class="sig-name descname">RayData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.RayData" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing ray casting results.</p>
<p>Objects of this class are returned by <a class="reference internal" href="#calcam.raycast_sightlines" title="calcam.raycast_sightlines"><code class="xref py py-func docutils literal notranslate"><span class="pre">calcam.raycast_sightlines()</span></code></a>.
It can also be used to save and load ray cast results to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – File name of netCDF file containing saved RayData to load.                           If not given, an empty RayData object is created.</p>
</dd>
</dl>
<dl class="py method">
<dt id="calcam.RayData.get_model_normals">
<code class="sig-name descname">get_model_normals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">im_position_tol</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.RayData.get_model_normals" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 3D unit normal vectors of the CAD model surface where the camera sight-lines hit the model.
Only available if calc_normals = True was given when running raycast_sightlines().</p>
<p>Note: it is advised to use this function rather than accessing the <cite>model_normals</cite>
attribute of the object directly because this function will respect any image cropping
applied using the set_detector_window() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> (<em>array-like</em>) – Image pixel coordinates at which to get the model normals.                                      If not specified, the end coordinates of all casted sight lines will be returned.</p></li>
<li><p><strong>im_position_tol</strong> (<em>float</em>) – If x and y are specified but no sight-line was cast at exactly the                                       input coordinates, the nearest casted sight-line will be returned                                       instead provided the pixel coordinates wre within this many pixels of                                       the requested coordinates.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Coords</span></code>, specifies what orientation the input x                                       and y correspond to or orientation of the returned array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array containing the normal vectors of the CAD model surface where                                      each sight line intersects the CAD model. If x and y coordinates were                                       given either to this function or to calcam.raycast_sightlines(), the shape of                                       this array is the same as the input x and y arrays with an additional                                       dimension added which contains the  [X,Y,Z] components of the normals. Otherwise the shape                                      is (h x w x 3) where w and h are the image width and height (in display coords).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.RayData.get_ray_directions">
<code class="sig-name descname">get_ray_directions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">im_position_tol</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.RayData.get_ray_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get unit vectors specifying the sight-line directions. Note that ray casting         is not required to get this information: see <a class="reference internal" href="#calcam.Calibration.get_los_direction" title="calcam.Calibration.get_los_direction"><code class="xref py py-func docutils literal notranslate"><span class="pre">calcam.Calibration.get_los_direction()</span></code></a>         for the same functionality, however this can be useful if you have the RayData         but not <a class="reference internal" href="#calcam.Calibration" title="calcam.Calibration"><code class="xref py py-class docutils literal notranslate"><span class="pre">calcam.Calibration</span></code></a> object loaded when doing the analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> (<em>array-like</em>) – x and y pixel coordinates at which to get the ray directions.                                       If not specified, the ray directions of every sight-line are returned.</p></li>
<li><p><strong>im_position_tol</strong> (<em>float</em>) – If x and y are specified but no sight-line was cast at exactly the                                       input coordinates, the nearest casted sight-line will be returned                                       instead provided the pixel coordinates wre within this many pixels of                                       the requested coordinates.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Original</span></code>, specifies what orientation the input x                                       and y correspond to or orientation of the returned array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array containing the sight-line directions. If the ray cast was for the                                       full detector and x and y are not specified, the array shape will be                                       (h x w x 3) where w nd h are the image width and height. Otherwise it will                                       be the same shape as the input x and y coordinates plus an extra dimension.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.RayData.get_ray_end">
<code class="sig-name descname">get_ray_end</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">im_position_tol</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.RayData.get_ray_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 3D x,y,z coordinates where the casted rays / sightlines intersect the CAD model.</p>
<p>Note: it is advised to use this function rather than accessing the <cite>ray_end_coords</cite>
attribute of the object directly because this function will respect any image cropping
applied using the set_detector_window() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> (<em>array-like</em>) – Image pixel coordinates at which to get the sight-line end coordinates.                                      If not specified, the end coordinates of all casted sight lines will be returned.</p></li>
<li><p><strong>im_position_tol</strong> (<em>float</em>) – If x and y are specified but no sight-line was cast at exactly the                                       input coordinates, the nearest casted sight-line will be returned                                       instead provided the pixel coordinates wre within this many pixels of                                       the requested coordinates.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Coords</span></code>, specifies what orientation the input x                                       and y correspond to or orientation of the returned array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array containing the 3D coordinates, in metres, of the points where                                      each sight line intersects the CAD model. If x and y coordinates were                                       given either to this function or to calcam.raycast_sightlines(), the shape of                                       this array is the same as the input x and y arrays with an additional                                       dimension added which contains the  [X,Y,Z] 3D coordinates. Otherwise the shape                                      is (h x w x 3) where w and h are the image width and height (in display coords).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.RayData.get_ray_lengths">
<code class="sig-name descname">get_ray_lengths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">im_position_tol</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.RayData.get_ray_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the sight-line lengths either of all casted sight-lines or at the specified image coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> (<em>array-like</em>) – Image pixel coordinates at which to get the sight-line lengths.                                       If not specified, the lengths of all casted sight lines will be returned.</p></li>
<li><p><strong>im_position_tol</strong> (<em>float</em>) – If x and y are specified but no sight-line was cast at exactly the                                       input coordinates, the nearest casted sight-line will be returned                                       instead provided the pixel coordinates wre within this many pixels of                                       the requested coordinates.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Coords</span></code>, specifies what orientation the input x                                       and y correspond to or orientation of the returned array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array containing the sight-line lengths. If the ray cast was for the                                       full detector and x and y are not specified, the array shape will be                                       (h x w) where w nd h are the image width and height. Otherwise it will                                       be the same shape as the input x and y coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.RayData.get_ray_start">
<code class="sig-name descname">get_ray_start</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">im_position_tol</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">'Display'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.RayData.get_ray_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 3D x,y,z coordinates of the “start” of the casted rays / sightlines.</p>
<p>Note: it is advised to use this function rather than accessing the <cite>ray_start_coords</cite>
attribute of the object directly because this function will respect any image cropping
applied using the set_detector_window() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> (<em>array-like</em>) – Image pixel coordinates at which to get the sight-line start coordinates.                                      If not specified, the start coordinates of all casted sight lines will be returned.</p></li>
<li><p><strong>im_position_tol</strong> (<em>float</em>) – If x and y are specified but no sight-line was cast at exactly the                                       input coordinates, the nearest casted sight-line will be returned                                       instead provided the pixel coordinates wre within this many pixels of                                       the requested coordinates.</p></li>
<li><p><strong>coords</strong> (<em>str</em>) – Either <code class="docutils literal notranslate"><span class="pre">Display</span></code> or <code class="docutils literal notranslate"><span class="pre">Coords</span></code>, specifies what orientation the input x                                       and y correspond to or orientation of the returned array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array containing the 3D coordinates, in metres, of the start of                                       each sight line (i.e. camera pupil position). If x and y coordinates were                                       given either to this function or to calcam.raycast_sightlines(), the shape of                                       this array is the same as the input x and y arrays with an additional                                       dimension added which contains the  [X,Y,Z] 3D coordinates. Otherwise the shape                                      is (h x w x 3) where w and h are the image width and height (in display coords).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="calcam.RayData.history">
<code class="sig-name descname">history</code><a class="headerlink" href="#calcam.RayData.history" title="Permalink to this definition">¶</a></dt>
<dd><p>Human readable description of where the raydata came from.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.RayData.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.RayData.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the RayData to a netCDF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – File name to save to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calcam.RayData.set_detector_window">
<code class="sig-name descname">set_detector_window</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window</span></em><span class="sig-paren">)</span><a class="headerlink" href="#calcam.RayData.set_detector_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust the raydata to apply to a different detector region for than was used
to perform the original raycast. Useful for example if a CMOS camera has been calibrated
over the full frame, but you now want to use this calibration for data which
has been cropped.</p>
<p>Calling this function with <cite>None</cite> as the single argument sets the raydata
back to its “native” state. Otherwise, call with a 4 element tuple specifying the
left,top,width and height of the detector window.</p>
<p>Detector window coordinates must always be in original coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window</strong> (<em>tuple</em><em> or </em><em>list</em>) – A 4-element tuple or list of integers defining the                                      detector window coordinates (Left,Top,Width,Height)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api_cadmodel.html" class="btn btn-neutral float-right" title="CAD Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gui_movement.html" class="btn btn-neutral float-left" title="Camera Movement Determination" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015-2022, European Atomic Energy Community (EURATOM)

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>